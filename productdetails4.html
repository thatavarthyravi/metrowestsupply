<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contractor Essentials Catalog</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="newstyles.css">
</head>

<body class="bg-white text-slate-900">

  <!-- Standard Header -->
  <header class="sticky top-0 z-50 bg-white border-b-2 border-[var(--navy-tint)] shadow-sm">
  <nav class="max-w-7xl mx-auto px-6 py-4 flex items-center">
    
    <!-- Logo (left) -->
    <div class="flex items-center space-x-3">
      <div class="bg-[var(--navy)] p-1.5 rounded">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
        </svg>
      </div>
      <span class="text-xl font-bold text-[var(--navy)]">
        Unit Turn<span class="text-[var(--orange)] ml-1">Supply</span>
      </span>
    </div>

    <!-- Navigation (right) -->
    <div class="hidden md:flex ml-auto space-x-8 text-sm font-bold text-[var(--navy-muted)] uppercase tracking-wider">
      <a href="index.html" class="hover:text-[var(--orange)] transition">Home</a>
      <a href="catalog.html" class="text-[var(--navy)] border-b-2 border-[var(--orange)]">Bundles</a>
      <a href="order-form.html" class="hover:text-[var(--orange)] transition">Order Now</a>
    </div>

  </nav>
</header>


  <main id="master-catalog" class="max-w-5xl mx-auto py-12 px-6 space-y-20"></main>

 <!-- Footer -->
<footer class="bg-white border-t border-slate-200 pt-10 pb-6">
  <div class="max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-3 gap-12 mb-6">

    <!-- Brand / About -->
    <div>
      <span class="text-xl font-bold text-slate-900">Unit Turn Supply</span>
      <p class="mt-4 text-sm text-slate-500 leading-relaxed">
        High-volume material fulfillment for restoration and tenant turn projects across North America.
      </p>
    </div>

    <!-- Help Center -->
    <div>
      <h4 class="font-bold text-slate-900 mb-4">Help Center</h4>
      <ul class="text-sm text-slate-600 space-y-2">
        <li><a href="bundles-faq.html" class="hover:text-orange-600">Bundles FAQ</a></li>
        <li><a href="shipping-faq.html" class="hover:text-orange-600">Shipping FAQ</a></li>
        <li><a href="terms.html" class="hover:text-orange-600">Terms of Sale</a></li>
      </ul>
    </div>

    <!-- Company -->
    <div>
      <h4 class="font-bold text-slate-900 mb-4">Company</h4>
      <ul class="text-sm text-slate-600 space-y-2">
        <li><a href="why-us.html" class="hover:text-orange-600">Why Us</a></li>
        <li><a href="privacy.html" class="hover:text-orange-600">Privacy Policy</a></li>
        <li><a href="catalog.html" class="hover:text-orange-600">Browse Bundles</a></li>
      </ul>
    </div>

  </div>

  <!-- Bottom bar -->
  <div class="text-center pt-4 border-t border-slate-100 text-xs text-slate-400">
    &copy; 2025 Unit Turn Supply. Material Management Specialists.
  </div>
</footer>

  <script>
    const masterContainer = document.getElementById('master-catalog');

    function escapeHtml(str) {
      return String(str ?? '')
        .replaceAll('&', '&amp;')
        .replaceAll('<', '&lt;')
        .replaceAll('>', '&gt;')
        .replaceAll('"', '&quot;')
        .replaceAll("'", '&#039;');
    }

    // ONE tab click handler for everything
    masterContainer.addEventListener('click', (e) => {
      const btn = e.target.closest('[data-tab-btn="true"]');
      if (!btn) return;

      const bundleId = btn.getAttribute('data-bundle');
      const panelId = btn.getAttribute('data-panel');

      const allBtns = masterContainer.querySelectorAll(`[data-tab-btn="true"][data-bundle="${bundleId}"]`);
      allBtns.forEach(b => {
        const active = b === btn;
        b.setAttribute('aria-selected', String(active));
        b.className = active
          ? 'px-4 py-2 rounded-t-lg text-sm font-bold bg-white text-slate-900 border border-slate-200 border-b-white'
          : 'px-4 py-2 rounded-t-lg text-sm font-bold bg-slate-50 text-slate-600 border border-transparent hover:bg-white hover:border-slate-200';
      });

      const allPanels = masterContainer.querySelectorAll(`[data-tab-panel="true"][data-bundle="${bundleId}"]`);
      allPanels.forEach(p => p.classList.add('hidden'));

      const activePanel = document.getElementById(panelId);
      if (activePanel) activePanel.classList.remove('hidden');
    });

    function hasItems(cat) {
      return Array.isArray(cat?.items) && cat.items.length > 0;
    }

    function renderCatalog(catalogData) {
      masterContainer.innerHTML = '';

      (catalogData.bundles || []).forEach((bundle, bundleIndex) => {
        const bundleId = `bundle-${bundleIndex}`;

        // ✅ Only keep categories that actually have items
        const categoriesWithItems = (bundle.categories || []).filter(hasItems);

        // If bundle has no categories with items, skip rendering bundle entirely
        if (!categoriesWithItems.length) return;

        const wrapper = document.createElement('div');

        // ✅ Bundle title: force high-contrast, always visible
        wrapper.innerHTML = `
          <h2 class="text-3xl font-black text-slate-900 tracking-tight border-b-4 border-slate-200 pb-3 mb-6">
            ${escapeHtml(bundle.name || '')}
          </h2>
        `;

        // Tabs bar
        const tabsBar = document.createElement('div');
        tabsBar.className = 'flex flex-wrap gap-2 border-b border-slate-200 pb-3';
        tabsBar.setAttribute('role', 'tablist');

        const panelsWrap = document.createElement('div');

        categoriesWithItems.forEach((cat, catIndex) => {
          const tabId = `${bundleId}-tab-${catIndex}`;
          const panelId = `${bundleId}-panel-${catIndex}`;
          const isActive = catIndex === 0;

          // Tab button
          const btn = document.createElement('button');
          btn.type = 'button';
          btn.id = tabId;
          btn.setAttribute('role', 'tab');
          btn.setAttribute('data-tab-btn', 'true');
          btn.setAttribute('data-bundle', bundleId);
          btn.setAttribute('data-panel', panelId);
          btn.setAttribute('aria-controls', panelId);
          btn.setAttribute('aria-selected', String(isActive));

          btn.className = isActive
            ? 'px-4 py-2 rounded-t-lg text-sm font-bold bg-white text-slate-900 border border-slate-200 border-b-white'
            : 'px-4 py-2 rounded-t-lg text-sm font-bold bg-slate-50 text-slate-600 border border-transparent hover:bg-white hover:border-slate-200';

          btn.innerHTML = `
            <span class="mr-2 inline-flex items-center justify-center text-xs font-extrabold px-2 py-0.5 rounded bg-slate-200 text-slate-900">
              ${catIndex + 1}
            </span>
            ${escapeHtml(cat.category || '')}
          `;

          tabsBar.appendChild(btn);

          // Panel
          const panel = document.createElement('section');
          panel.id = panelId;
          panel.setAttribute('role', 'tabpanel');
          panel.setAttribute('aria-labelledby', tabId);
          panel.setAttribute('data-tab-panel', 'true');
          panel.setAttribute('data-bundle', bundleId);
          panel.className = isActive ? '' : 'hidden';

          panel.innerHTML = `
            <div class="grid gap-4 mt-6">
              ${(cat.items || []).map(item => {
                const product = escapeHtml(item.product || '');
                const brands = Array.isArray(item.brands) ? item.brands.map(escapeHtml) : [];
                const qty = escapeHtml(item.qty ?? item.typical_quantity ?? '');
                const url = escapeHtml(item.url ?? item.url_placeholder ?? '#');

                const rawImage = item.image ?? item.image_path_placeholder ?? '';
                const fileName = String(rawImage).split('/').pop();
                const imagePath = fileName ? `images/${escapeHtml(fileName)}` : 'https://placehold.co/80x80?text=No+Image';

                return `
                  <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                      <div class="w-20 h-20 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 border">
                        <img src="${imagePath}"
                             alt="${product}"
                             class="w-full h-full object-cover"
                             onerror="this.onerror=null; this.src='https://placehold.co/80x80?text=No+Image';">
                      </div>
                      <div>
                        <h4 class="font-bold text-gray-900">${product}</h4>
                        <p class="text-sm text-gray-500">${brands.join(", ")}</p>
                        <span class="text-xs font-bold text-blue-600 bg-blue-50 px-2 py-0.5 rounded mt-1 inline-block">
                          Minimum Qty: ${qty}
                        </span>
                      </div>
                    </div>
                    <a href="${url}" class="bg-slate-800 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-slate-700 transition">
                      View Details
                    </a>
                  </div>
                `;
              }).join('')}
            </div>
          `;

          panelsWrap.appendChild(panel);
        });

        wrapper.appendChild(tabsBar);
        wrapper.appendChild(panelsWrap);
        masterContainer.appendChild(wrapper);
      });
    }

    fetch('./data/miniproductbundles.json')
      .then(res => res.json())
      .then(renderCatalog)
      .catch(err => {
        console.error(err);
        masterContainer.innerHTML = `
          <div class="bg-white p-6 rounded-xl border border-red-200">
            <h2 class="text-xl font-bold text-red-700">Failed to load catalog</h2>
          </div>
        `;
      });
  </script>
</body>
</html>
